# 测试计划

## 1. 测试概述

### 1.1 测试目标
- 确保系统功能正确性
- 验证系统安全性和稳定性
- 保证代码质量和可维护性

### 1.2 测试范围
- **后端API测试**：认证、用户管理等核心功能
- **前端组件测试**：登录、注册、用户管理等页面
- **集成测试**：前后端联调测试
- **安全测试**：权限控制、XSS防护等

## 2. 测试策略

### 2.1 单元测试
- **后端**：使用 pytest 测试所有API端点
- **前端**：使用 Vitest 测试组件和状态管理

### 2.2 集成测试
- 测试前后端完整交互流程
- 测试数据库操作
- 测试认证和授权流程

### 2.3 端到端测试（E2E）
- 用户注册流程
- 用户登录流程
- 管理员用户管理流程

## 3. 测试用例

### 3.1 认证功能测试

#### 3.1.1 用户注册
- ✅ 正常注册流程
- ✅ 重复用户名注册
- ✅ 重复邮箱注册
- ✅ 表单验证（必填项、格式验证）

#### 3.1.2 用户登录
- ✅ 正常登录流程
- ✅ 错误密码登录
- ✅ 不存在的用户登录
- ✅ 已禁用用户登录

#### 3.1.3 获取当前用户
- ✅ 正常获取用户信息
- ✅ 未授权访问
- ✅ 无效token访问

### 3.2 用户管理功能测试

#### 3.2.1 创建用户（管理员）
- ✅ 管理员创建普通用户
- ✅ 管理员创建管理员用户
- ✅ 普通用户尝试创建用户（权限拒绝）
- ✅ 未授权创建用户
- ✅ 重复用户名/邮箱创建

#### 3.2.2 获取用户列表（管理员）
- ✅ 管理员获取用户列表
- ✅ 普通用户尝试获取列表（权限拒绝）
- ✅ 分页功能测试

#### 3.2.3 获取用户统计
- ✅ 所有登录用户可访问
- ✅ 统计数据准确性

#### 3.2.4 删除用户（管理员）
- ✅ 管理员删除普通用户
- ✅ 管理员无法删除自己
- ✅ 管理员无法删除其他管理员
- ✅ 普通用户无法删除用户
- ✅ 删除不存在的用户

### 3.3 前端组件测试

#### 3.3.1 登录页面
- ✅ 表单渲染
- ✅ 表单验证
- ✅ 用户输入
- ✅ 导航到注册页面

#### 3.3.2 注册页面
- ✅ 表单渲染
- ✅ 表单验证（用户名、邮箱、密码）
- ✅ 密码确认验证
- ✅ 注册成功跳转

#### 3.3.3 用户管理页面
- ✅ 用户列表显示
- ✅ 创建用户对话框
- ✅ 删除用户确认
- ✅ 权限控制（按钮禁用）

### 3.4 安全测试

#### 3.4.1 权限控制
- ✅ 未登录用户无法访问受保护页面
- ✅ 普通用户无法访问管理员功能
- ✅ Token过期处理

#### 3.4.2 XSS防护
- ✅ 用户输入自动转义（Vue 3默认）
- ✅ Element Plus组件自动转义

#### 3.4.3 密码安全
- ✅ 密码加密存储（bcrypt）
- ✅ 密码不在响应中返回

## 4. 测试环境

### 4.1 后端测试环境
- Python 3.12
- SQLite内存数据库（测试用）
- pytest + pytest-asyncio + httpx

### 4.2 前端测试环境
- Node.js 18+
- Vitest + @vue/test-utils
- jsdom（DOM模拟）

## 5. 测试覆盖率目标

- **后端单元测试覆盖率**：≥ 80%
- **前端组件测试覆盖率**：≥ 70%
- **关键功能覆盖率**：100%

## 6. 测试执行

### 6.1 本地测试
```bash
# 后端测试
cd backend
pytest tests/ -v --cov=app

# 前端测试
cd frontend
npm run test
npm run test:coverage
```

### 6.2 CI/CD自动测试
- 每次 Push 和 Pull Request 自动执行
- 测试失败阻止合并
- 自动生成覆盖率报告

## 7. 缺陷管理

### 7.1 缺陷分类
- **严重（P0）**：系统崩溃、数据丢失
- **高（P1）**：核心功能不可用
- **中（P2）**：功能异常但不影响主要流程
- **低（P3）**：UI问题、优化建议

### 7.2 缺陷跟踪
- 使用 GitHub Issues 跟踪缺陷
- 缺陷模板包含：描述、复现步骤、预期行为、实际行为、环境信息

## 8. 回归测试

### 8.1 回归测试策略
- 每次发布前执行完整测试套件
- 修复缺陷后执行相关测试用例
- 定期执行完整回归测试

### 8.2 回归测试范围
- 所有已修复的缺陷相关功能
- 核心业务流程
- 安全相关功能

## 9. 性能测试（未来）

### 9.1 性能指标
- API响应时间 < 200ms
- 页面加载时间 < 2s
- 并发用户支持

### 9.2 性能测试工具
- Apache Bench (ab)
- JMeter
- k6

## 10. 测试报告

### 10.1 测试报告内容
- 测试执行摘要
- 测试用例执行结果
- 缺陷统计和分析
- 覆盖率报告
- 风险评估

### 10.2 报告生成
- CI/CD自动生成测试报告
- 覆盖率报告上传到 Codecov
- 定期生成测试总结报告



